{% extends "base.html" %}
{% load static %}

{% block title %}Register - SchoolSystem{% endblock %}

{% block alt_content %}
<script src="https://unpkg.com/htmx.org@1.9.12"></script>

<div class="max-w-lg mx-auto bg-white rounded-xl shadow-lg p-8 mt-10">
  <h2 class="text-3xl font-bold text-center text-primary-600 mb-6">
    Create Your Account
  </h2>
  <p class="text-center text-neutral-500 mb-8">
    Join SchoolSystem and access your personalized dashboard.
  </p>

  <form method="post" class="space-y-6">
    {% csrf_token %}

    <!-- Username -->
    <div>
      <label for="{{ form.username.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Username
      </label>
      <div class="relative">
        <i class="fas fa-user absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.username }}
      </div>
    </div>

    <!-- Email -->
    <div>
      <label for="{{ form.email.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Email
      </label>
      <div class="relative">
        <i class="fas fa-envelope absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.email }}
      </div>
    </div>

    <!-- Phone -->
    <div>
      <label for="{{ form.phone.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Phone
      </label>
      <div class="relative">
        <i class="fas fa-phone absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.phone }}
      </div>
    </div>

    <!-- Role -->
    <div>
      <label for="{{ form.role.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Role
      </label>
      <div class="relative">
        <i class="fas fa-user-tag absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.role }}
      </div>
    </div>

    

    <!-- Password -->
    <div>
      <label for="{{ form.password1.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Password
      </label>
      <div class="relative">
        <i class="fas fa-lock absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.password1 }}
      </div>
    </div>

    <!-- Confirm Password -->
    <div>
      <label for="{{ form.password2.id_for_label }}" class="block text-sm font-medium text-neutral-700 mb-1">
        Confirm Password
      </label>
      <div class="relative">
        <i class="fas fa-lock absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400"></i>
        {{ form.password2 }}
      </div>
    </div>

    <!-- Submit -->
    <button type="submit" class="max-w-md bg-primary-600 hover:bg-primary-700 text-white py-2 px-4 rounded-lg shadow transition">
      <i class="fas fa-user-plus mr-2"></i> Create Account
    </button>
  </form>

  <p class="text-center text-sm text-neutral-600 mt-6">
    Already have an account?
    <a href="{% url 'accounts:login' %}" class="text-primary-600 hover:underline font-medium">
      Login here
    </a>
  </p>
</div>

<!-- Small JS for conditional school field -->
<script>
  const roleSelect = document.getElementById("id_role");
  const schoolField = document.getElementById("school-field");

  function toggleSchoolField() {
    if (roleSelect.value === "SUPER_ADMIN") {
      schoolField.style.display = "none";
    } else {
      schoolField.style.display = "block";
    }
  }

  // Run once on load + whenever role changes
  toggleSchoolField();
  roleSelect.addEventListener("change", toggleSchoolField);
</script>
{% endblock %}
